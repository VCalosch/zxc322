<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Socorristas</title>
  <% include partials/head %>
</head>


<script type="text/javascript">
  window.eventos = <%- JSON.stringify(Eventos) %>
</script>
<script>
    function onChange() {
      var id = document.getElementById("eventosSelect").value; 
   

      const event = eventos.filter((ev) => ev._id == id)
     
      let descriptionsHTML = ''
      event[0].descripcion.forEach(des => {
        descriptionsHTML += `<option value=${des.name}> ${des.name} </option>`
      })
      document.getElementById("descripcionSelect").innerHTML = descriptionsHTML;
    }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3d6OC5uV4aQlVClt97CEULYxOvY7b1GU&callback=initMap">
</script>
<script>
    var map;
    var currentLatitud;
    var currentLongitud;

    var isMarcador = false;
    var isPoligono;
    var Marcador = 0;
    var latitud, longitud;
    var cerrarPoligono = 0;
    var poligono;
    var marker;
    var insertarPoligono = true;


    var list = [];
    var numeros = [];

    var listPolygon = [];
    var numerosPolygon = [];

    



    function EliminarMarcador() {
        marker.setMap(null);
        Marcador = 0;
        longitud = null;
        latitud = null;


        marcadorCounter=0;
        

    }


    

    function initMap(position) {

        //Valores Iniciales para Mapa
        var options = {
                zoom: 15,
                center: {
                  lat:43.477373,lng:-3.787489
                }
            }
            // Defininar Mapa
        map = new google.maps.Map(document.getElementById('map'), options);



        
        google.maps.event.addListener(map, 'click', function(event) {
            
            if (Marcador == 0) {
                marker = addMarker({
                    coords: event.latLng
                });
                latitud = event.latLng.lat();
                longitud = event.latLng.lng();
                marcadorCounter=1;
               
                document.getElementById("eliminarMarcador").style.display = "block";
                
                Marcador = 1;
                } 
                
                marker.addListener('dragend', function(event) {
                    latitud = event.latLng.lat();
                    longitud = event.latLng.lng();
                    
                });

        });

        function addMarker(props) {
            var marker = new google.maps.Marker({
                position: props.coords,
                map: map,
                draggable:true
            });
            return marker;
        }



    }

    //---------------------------------------------ELIMINAR MARCADOR------------------------------------------------------------------------
</script>


<div class="dashboard_container top-container">
    <div class="row">
        
      <!--SideBar Coordinador/Socorrista-->
      <div class="col-2">
          <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">Coordinador</a>
                <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">Socorrista</a>
          </div>
      </div>

        <div class="col">


            <div class="tab-content" id="v-pills-tabContent">
                  <!--Herramientas de Coordinador-->
                  <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
                            <ul class="nav nav-tabs" id="myTab" role="tablist">
                              <li class="nav-item">
                                <a class="nav-link active" id="ModificarPlaya-tab" data-toggle="tab" href="#ModificarPlaya" role="tab" aria-controls="ModificarPlaya" aria-selected="true">Modificar Playa</a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" id="UbicarServicios-tab" data-toggle="tab" href="#UbicarServicios" role="tab" aria-controls="UbicarServicios" aria-selected="false">Ubicar Servicios en Playa</a>
                              </li>
                              <li class="nav-item">
                                  <a class="nav-link" id="DarAltaRiesgo-tab" data-toggle="tab" href="#DarAltaRiesgo" role="tab" aria-controls="DarAltaRiesgo" aria-selected="false">Dar de Alta un Riesgo</a>
                                </li>
                            </ul>
                            <div class="tab-content" id="myTabContent">
                          
                          
                                <div class="tab-pane fade show active" id="ModificarPlaya" role="tabpanel" aria-labelledby="ModificarPlaya-tab">
                                      <div class="card">
                                        <div class="card-body Margenes">
                                          <h1>Modificar Playa</h1>
                                          <div class="form-row">
                                              <div class="col"></div>
                                              <div class="col">
                                                  <button type="button" class="btn btn-secondary btn-sm float-right" style="display: none;" id="eliminarMarcador" onclick="EliminarMarcador()">Eliminar Marcador</button>
                                              </div>
                                          </div>
                                         <div class="form-row"><div id="map"></div></div>
                                        </div>
                                      </div>
                                </div>
                                <div class="tab-pane fade" id="UbicarServicios" role="tabpanel" aria-labelledby="UbicarServicios-tab">
                                    <div class="card">
                                      <div class="card-body Margenes">
                                        <h1>Ubicar Servicios</h1>
                                      </div>
                                    </div>
                              </div>
                              <div class="tab-pane fade" id="DarAltaRiesgo" role="tabpanel" aria-labelledby="DarAltaRiesgo-tab">
                                  <div class="card">
                                    <div class="card-body Margenes">
                                      <h1>Dar de Alta un Riesgo</h1>
                                    </div>
                                  </div>
                            </div>
                                
                            </div>
                  </div>
                  <!--Herramientas de Socorrista-->
                  <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item">
                              <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Incidentes/Intervenciones</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Avisos Preventivos</a>
                            </li>
                        </ul>
                        <div class="tab-content" id="myTabContent">
                        
                        
                              <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                                    <div class="card">
                        
                                    <div class="card-body Margenes">
                                    
                                      <form action="/addIncInt" method="post">
                                        <div class="form-row"><div class="col"></div>
                                            <div class="form-check col-auto">
                                              <input class="form-check-input" type="checkbox" value="Fuera" name="horario" id="defaultCheck1">
                                              <label class="form-check-label" for="defaultCheck1">Fuera de Horario</label>
                                            </div>
                                            <div class="col"></div>
                                          </div>
                                          <br> 
                                          <div class="form-row">
                                            <div class="col">
                                                <select onchange="onChange()" id="eventosSelect" name="Eventos" class="form-control">
                                                    <option disabled selected value="">Eventos</option>
                                                  <% for(var i=0; i<Eventos.length; i++) {%>
                                                      <option value='<%= Eventos[i]._id %>'><%= Eventos[i].evento %></option>
                                                    <% } %>
                                                  </select>
                                            </div>
                                            <div class="col">
                                                <select  id="descripcionSelect" onchange="" name="descripcion" class="form-control"> 
                                                    <option disabled selected value="">Descripci√≥n</option>
                        
                                                </select>
                                            </div>
                                            <div class="col">
                                                <select name="Eventos" class="form-control">
                                                    <option disabled selected value="">Consecuencia</option>
                                                    <% for(var i=0; i<consecuencia.length; i++) {%> 
                                                  <option id="consecuencia" value='<%= consecuencia[i]._id %>'><%= consecuencia[i].consecuencia %></option> 
                                                    <% } %>
                                                </select>
                                            </div>
                                          </div>
                                          <br>
                                          <div class="form-row">
                                              <div class="col"></div>
                                              <div class="col-auto"><button class="btn btn-primary">Agregar Incidente</button></div>
                                              <div class="col"></div>
                                          </div>
                        
                                      </form>
                                      </div>
                                    </div>
                              </div>
                        
                        
                        
                        
                        
                              
                              <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                                <div class="card">
                                  <div class="card-body Margenes">
                                        <div class="form-row">
                                          <div class="col"></div>
                                          <div class="col-auto">
                                        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                              <li class="nav-item">
                                              <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Acciones Preventivas (Actuaciones Activas)</a>
                                              </li>
                                              <li class="nav-item">
                                              <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Acciones Preventivas (Actuaciones reactivas)</a>
                                              </li>
                                      </ul></div>
                                      <div class="col"></div>
                                    </div>
                                    <div class="tab-content" id="pills-tabContent">
                                          <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                                            <br><br>
                        
                                            <div style="margin-left: 60px; margin-right: 60px;">
                                              <div class="card-columns">
                                                <% for(var i=0; i<Actuacionesactivas.length; i++) {%>
                                                <div class="card text-center">
                                                    <div class="card-body">
                                                      <h5 class="card-title"><%= Actuacionesactivas[i].ActuacionActivas %></h5>
                                                    </div>
                                                  </div>
                                                  <% }%>
                                                </div>
                                            </div>
                        
                        
                                          </div>
                                          <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                        
                                            <br><br>
                                          <div style="margin-left: 60px; margin-right: 60px;">
                                            <div class="card-columns">
                                              <% for(var i=0; i<Actuacionesreactivas.length; i++) {%>
                                                <div class="card">
                                                  <div class="card-body">
                                                    <h5 class="card-title"><%= Actuacionesreactivas[i].ActuacionreactivasNombre %></h5>
                                                    <a href='GestionEventos/addReactForm/<%= Actuacionesreactivas[i].id%>' class="card-link">Agregar</a>
                                                  </div>
                                                </div>
                                                <% }%>
                                            </div>
                                          </div>
                        
                        
                                          </div>
                                    </div>
                        
                                  </div>
                                </div>
                              </div>
                        
                        
                        
                        
                        
                        
                        
                        </div>
                  </div>
            </div>
</div></div>

</html>